include:
  - project: univention/dist/docker-services
    file: kaniko.yml


build-portal-frontend-test-runner:
  extends: .kaniko
  variables:
    KANIKO_BUILD_CONTEXT: "frontend"
    CI_REGISTRY_IMAGE: "$CI_REGISTRY_IMAGE/portal-frontend"
    KANIKO_ARGS: "--target=test --cache=true"


build-portal-frontend:
  extends: .kaniko
  needs:
      - build-portal-frontend-test-runner
  variables:
    KANIKO_BUILD_CONTEXT: "frontend"
    CI_REGISTRY_IMAGE: "$CI_REGISTRY_IMAGE/portal-frontend"
    KANIKO_ARGS: "--cache=true"
