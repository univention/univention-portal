# SPDX-License-Identifier: AGPL-3.0-only
# SPDX-FileCopyrightText: 2023-2024 Univention GmbH

---
{{ include "common.secret" (dict "top" . "overrides" "portal-consumer.secret") }}

{{- define "portal-consumer.secret" }}
{{- with .top }}
data:
{{- if .Values.global.nubusDeployment }}
  ldap_secret: ""
  machine_secret: ""
{{- else }}
  ldap_secret: {{ required "The parameter \"portalConsumer.ldapSecret\" is required." .Values.portalConsumer.ldapSecret | b64enc | quote }}
  machine_secret: {{ required "The parameter \"portalConsumer.machineSecret\" is required." .Values.portalConsumer.machineSecret | b64enc | quote }}
{{- end }}
  ca_cert: {{ .Values.portalConsumer.caCert | quote }}
  cert_pem: {{ .Values.portalConsumer.certPem | quote }}
{{- end }}
{{- end -}}
