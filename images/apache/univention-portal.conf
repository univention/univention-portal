# Warning: This file is auto-generated and might be overwritten by
#          univention-config-registry.
#          Please edit the following file(s) instead:
# Warnung: Diese Datei wurde automatisch generiert und kann durch
#          univention-config-registry ueberschrieben werden.
#          Bitte bearbeiten Sie an Stelle dessen die folgende(n) Datei(en):
#
# 	/etc/univention/templates/files/etc/apache2/sites-available/univention-portal.conf
#


<LocationMatch "^/univention/portal/.*$">
	Header always setifempty "Content-Security-Policy" "default-src 'self' 'unsafe-inline' 'unsafe-eval' https://www.piwik.univention.de/; style-src-elem 'self' 'sha256-kDRQ3dagwwb3nrm8xnMC0VgLt6lNN98+2oajznduaKI='; font-src 'self'; img-src data: *; frame-src *; connect-src 'self' https://ucs-sso.univention.intranet/ http://ucs-sso.univention.intranet/; frame-ancestors 'self' https://ucs-sso.univention.intranet/ http://ucs-sso.univention.intranet/;"
</LocationMatch>


<LocationMatch "^/univention/umc/.*$">
	Header always setifempty "Content-Security-Policy" "default-src 'self' 'unsafe-inline' 'unsafe-eval' https://www.piwik.univention.de/; style-src-elem 'self' 'sha256-kDRQ3dagwwb3nrm8xnMC0VgLt6lNN98+2oajznduaKI='; font-src 'self'; img-src data: *; frame-src *; connect-src 'self' https://ucs-sso.univention.intranet/ http://ucs-sso.univention.intranet/; frame-ancestors 'self' https://ucs-sso.univention.intranet/ http://ucs-sso.univention.intranet/;"
</LocationMatch>


# Note: Below is copied in to make something work at all.

# TODO: Hack to avoid that the frontend app is proxied
ProxyPassMatch /(univention/portal/portal.json) http://portal-server:8095/$1 retry=0
ProxyPassMatch /(univention/portal/groups.json) http://portal-server:8095/$1 retry=0

<Directory /var/www/univention/portal/>
	<FilesMatch "(portal|apps)\.json|portal\.css">
		Header set Cache-Control "max-age=0, must-revalidate"
	</FilesMatch>
</Directory>
<Directory /var/www/univention/portal/>
	Header set Cache-Control "max-age=0, must-revalidate"
</Directory>


ProxyPassMatch /(univention/umc/.*) http://portal-server:8095/$1 retry=0

<Directory /var/www/univention/umc/>
	<FilesMatch "(portal|apps)\.json|portal\.css">
		Header set Cache-Control "max-age=0, must-revalidate"
	</FilesMatch>
</Directory>
<Directory /var/www/univention/umc/>
	Header set Cache-Control "max-age=0, must-revalidate"
</Directory>